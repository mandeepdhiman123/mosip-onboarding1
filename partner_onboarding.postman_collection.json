{
	"info": {
		"_postman_id": "fe5ada00-e755-4b49-851e-dffff416025a",
		"name": "partner_onboarding",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "create_keycloak_user",
			"item": [
				{
					"name": "login-to-keycloak-as-admin",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);\r",
									"//var data = JSON.stringify(jsonData);\r",
									"console.log(jsonData.access_token);\r",
									"pm.environment.set(\"keycloak-token\", jsonData.access_token);\r",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/x-www-form-urlencoded",
								"type": "text"
							}
						],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "admin-cli",
									"type": "text"
								},
								{
									"key": "username",
									"value": "{{keycloak-admin-username}}",
									"type": "text"
								},
								{
									"key": "password",
									"value": "{{keycloak-admin-password}}",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{keycloak-url}}/auth/realms/master/protocol/openid-connect/token",
							"host": [
								"{{keycloak-url}}"
							],
							"path": [
								"auth",
								"realms",
								"master",
								"protocol",
								"openid-connect",
								"token"
							]
						}
					},
					"response": []
				},
				{
					"name": "create-user",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable('requesttime', (new Date()).toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{keycloak-token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"username\": \"{{partner-kc-username}}\",\r\n    \"firstName\": \"{{partner-kc-user-firstname}}\",\r\n    \"lastName\": \"{{partner-kc-user-lastname}}\",\r\n    \"email\": \"{{partner-kc-user-email}}\",\r\n    \"enabled\": true,\r\n    \"credentials\": [\r\n        {\r\n            \"temporary\": false,\r\n            \"type\": \"password\",\r\n            \"value\": \"{{partner-kc-userpassword}}\"\r\n        }\r\n    ]\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{keycloak-url}}/auth/admin/realms/mosip/users",
							"host": [
								"{{keycloak-url}}"
							],
							"path": [
								"auth",
								"admin",
								"realms",
								"mosip",
								"users"
							]
						}
					},
					"response": []
				},
				{
					"name": "get-user-details",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);\r",
									"const responsedata = jsonData.find(u => u.username === pm.environment.get('partner-kc-username'))\r",
									"console.log(responsedata);\r",
									"var userid = responsedata.id;\r",
									"console.log(userid);\r",
									"pm.environment.set(\"partner-kc-userid\",userid);"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable('requesttime', (new Date()).toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{keycloak-token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{keycloak-url}}/auth/admin/realms/mosip/users?username={{partner-kc-username}}",
							"host": [
								"{{keycloak-url}}"
							],
							"path": [
								"auth",
								"admin",
								"realms",
								"mosip",
								"users"
							],
							"query": [
								{
									"key": "username",
									"value": "{{partner-kc-username}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "get-role-id-for-all-roles",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);\r",
									"const responsedata = jsonData.find(rid => rid.name === pm.environment.get('partner-kc-user-role'))\r",
									"console.log(responsedata);\r",
									"var roleid = responsedata.id;\r",
									"console.log(roleid);\r",
									"pm.environment.set(\"roleid\",roleid);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{keycloak-token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{keycloak-url}}/auth/admin/realms/mosip/roles",
							"host": [
								"{{keycloak-url}}"
							],
							"path": [
								"auth",
								"admin",
								"realms",
								"mosip",
								"roles"
							]
						}
					},
					"response": []
				},
				{
					"name": "assign-role-to-user",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{keycloak-token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "[ \r\n    {\"id\" : \"{{roleid}}\",\r\n   \"name\":\"{{partner-kc-user-role}}\"}\r\n]",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{keycloak-url}}/auth/admin/realms/mosip/users/{{partner-kc-userid}}/role-mappings/realm",
							"host": [
								"{{keycloak-url}}"
							],
							"path": [
								"auth",
								"admin",
								"realms",
								"mosip",
								"users",
								"{{partner-kc-userid}}",
								"role-mappings",
								"realm"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "create_partner_policy_and_policy_group",
			"item": [
				{
					"name": "authentication-as-partner-manager/global-admin",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable('requesttime', (new Date()).toISOString());\r",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);\r",
									"console.log(jsonData.response.token);\r",
									"pm.environment.set(\"partner-admin-token\", jsonData.response.token);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"type": "text",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"id\": \"\",\n    \"version\": \"LTS\",\n    \"requesttime\": \"2022-03-25T08:33:39.713Z\",\n    \"metadata\": {},\n    \"request\": {\n        \"userName\": \"{{admin-username}}\",\n        \"password\": \"{{admin-password}}\",\n        \"appId\": \"{{application-id}}\",\n        \"clientId\": \"mosip-admin-client\",\n        \"clientSecret\": \"{{mosip-admin-client-secret}}\"\n    }\n}"
						},
						"url": {
							"raw": "{{url}}/v1/authmanager/authenticate/internal/useridPwd",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"authmanager",
								"authenticate",
								"internal",
								"useridPwd"
							]
						}
					},
					"response": []
				},
				{
					"name": "create-policy-group",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('set policy id',function(){\r",
									"    const {response} =pm.response.json();\r",
									"    pm.environment.set('policy-group-id',response.id);\r",
									"})\r",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable('requesttime', (new Date()).toISOString());\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "Authorization={{partner-admin-token}}",
									"type": "string"
								},
								{
									"key": "key",
									"value": "Cookie",
									"type": "string"
								},
								{
									"key": "in",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"id\": \"\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"desc\":\"PolicyGroup\",\r\n    \"name\":\"{{policy-group-name}}\"\r\n  },\r\n  \"requesttime\": \"{{requesttime}}\",\r\n  \"version\": \"LTS\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/policymanager/policies/group/new",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"policymanager",
								"policies",
								"group",
								"new"
							]
						}
					},
					"response": []
				},
				{
					"name": "create-policy",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable('requesttime', (new Date()).toISOString());\r",
									"const policydata = pm.iterationData.toObject();\r",
									"console.log(JSON.stringify(policydata));\r",
									"pm.environment.set('policy-data', JSON.stringify(policydata));\r",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('set policy id',function(){\r",
									"    const {response} =pm.response.json();\r",
									"    pm.environment.set('policy-id',response.id);\r",
									"})\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "Authorization={{partner-admin-token}}",
									"type": "string"
								},
								{
									"key": "key",
									"value": "Cookie",
									"type": "string"
								},
								{
									"key": "in",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{{policy-data}}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/policymanager/policies",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"policymanager",
								"policies"
							]
						}
					},
					"response": []
				},
				{
					"name": "publish-policy-and-policy-group",
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "Authorization={{partner-admin-token}}",
									"type": "string"
								},
								{
									"key": "key",
									"value": "Cookie",
									"type": "string"
								},
								{
									"key": "in",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{url}}/v1/policymanager/policies/{{policy-id}}/group/{{policy-group-id}}/publish",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"policymanager",
								"policies",
								"{{policy-id}}",
								"group",
								"{{policy-group-id}}",
								"publish"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "partner_self_registration",
			"item": [
				{
					"name": "authenticate-as-partner",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable('requesttime', (new Date()).toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"type": "text",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"id\": \"string\",\n  \"version\": \"string\",\n  \"requesttime\": \"{{requesttime}}\",\n  \"metadata\": {},\n  \"request\": {\n    \"userName\": \"{{partner-kc-username}}\",\n    \"password\": \"{{partner-kc-userpassword}}\",\n    \"appId\": \"partner\"\n  }\n}"
						},
						"url": {
							"raw": "{{url}}/v1/authmanager/authenticate/useridPwd",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"authmanager",
								"authenticate",
								"useridPwd"
							]
						}
					},
					"response": []
				},
				{
					"name": "partner-self-registration",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable('requesttime', (new Date()).toISOString());"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"id\": \"string\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"address\": \"{{partner-address}}\",\r\n    \"contactNumber\": \"{{partner-contact}}\",\r\n    \"emailId\": \"{{partner-kc-user-email}}\",\r\n    \"organizationName\": \"{{partner-kc-username}}\",\r\n    \"partnerId\": \"{{partner-kc-username}}\",\r\n    \"partnerType\": \"{{partner-type}}\",\r\n    \"policyGroup\": \"{{policy-group-name}}\"\r\n  },\r\n  \"requesttime\": \"{{requesttime}}\",\r\n  \"version\": \"LTS\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/partnermanager/partners",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"partnermanager",
								"partners"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "misc",
			"item": [
				{
					"name": "mapping-new-partner-to-policyname",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('adding apikeyrequestID',function(){\r",
									"    const {response} =pm.response.json();\r",
									"    pm.environment.set('mappingkey',response.mappingkey);\r",
									"})"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable('requesttime', (new Date()).toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"id\": \"string\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"policyName\": \"{{policy-name}}\",\r\n    \"useCaseDescription\": \"mapping partner to policy name\"\r\n  },\r\n  \"requesttime\": \"{{requesttime}}\",\r\n  \"version\": \"string\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/partnermanager/partners/{{partner-kc-username}}/policy/map",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"partnermanager",
								"partners",
								"{{partner-kc-username}}",
								"policy",
								"map"
							]
						}
					},
					"response": []
				},
				{
					"name": "create-apikey-for-partner",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('getting apikey',function(){\r",
									"    const {response} =pm.response.json();\r",
									"    pm.environment.set('apikey',response.apiKey);\r",
									"})"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable('requesttime', (new Date()).toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"id\": \"string\",\r\n  \"version\": \"string\",\r\n  \"requesttime\": \"{{requesttime}}\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"policyName\": \"{{policy-name}}\",\r\n    \"label\": \"{{partner-kc-userid}}\"\r\n  }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/partnermanager/partners/{{partner-kc-username}}/generate/apikey",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"partnermanager",
								"partners",
								"{{partner-kc-username}}",
								"generate",
								"apikey"
							]
						}
					},
					"response": []
				},
				{
					"name": "approve-partner-api-key-request",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable('requesttime', (new Date()).toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"id\": \"string\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"status\": \"Approved\"\r\n  },\r\n  \"requesttime\": \"{{requesttime}}\",\r\n  \"version\": \"string\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/partnermanager/partners/policy/{{mappingkey}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"partnermanager",
								"partners",
								"policy",
								"{{mappingkey}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "mapping-credential-type-partner-to-policy",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{url}}/v1/partnermanager/partners/{{partner-kc-username}}/credentialtype/{{credential-type}}/policies/{{policy-name}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"partnermanager",
								"partners",
								"{{partner-kc-username}}",
								"credentialtype",
								"{{credential-type}}",
								"policies",
								"{{policy-name}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "generate-the-MISP-license-key",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('created',function(){\r",
									"    const {response} =pm.response.json();\r",
									"    pm.environment.set('misplicensekey',response.licenseKey);\r",
									"})"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable('requesttime', (new Date()).toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"id\": \"string\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"providerId\": \"{{partner-kc-username}}\"\r\n  },\r\n  \"requesttime\": \"{{requesttime}}\",\r\n  \"version\": \"string\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/partnermanager/misps",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"partnermanager",
								"misps"
							]
						}
					},
					"response": []
				},
				{
					"name": "adding-bioextractors-for-partner",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n\t\"id\": \"string\",\r\n\t\"metadata\": {},\r\n\t\"request\": {\r\n\t\t\"extractors\": [{\r\n\t\t\t\t\"attributeName\": \"photo\",\r\n\t\t\t\t\"biometric\": \"face\",\r\n\t\t\t\t\"extractor\": {\r\n\t\t\t\t\t\"provider\": \"t5-face-lowres\",\r\n\t\t\t\t\t\"version\": \"1.1\"\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"attributeName\": \"face\",\r\n\t\t\t\t\"biometric\": \"face\",\r\n\t\t\t\t\"extractor\": {\r\n\t\t\t\t\t\"provider\": \"dlib\",\r\n\t\t\t\t\t\"version\": \"3.2\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t\"requesttime\": \"{{requesttime}}\",\r\n\t\"version\": \"string\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/partnermanager/partners/{{partner-kc-username}}/bioextractors/{{policy-id}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"partnermanager",
								"partners",
								"{{partner-kc-username}}",
								"bioextractors",
								"{{policy-id}}"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "cert-download",
			"item": [
				{
					"name": "authenticating-as-partner-manager",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);\r",
									"console.log(jsonData.response.token);\r",
									"pm.environment.set(\"partner-admin-token\", jsonData.response.token);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"type": "text",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"id\": \"\",\n  \"version\": \"LTS\",\n  \"requesttime\":\"{{requesttime}}\",\n  \"metadata\": {},\n  \"request\": {\n    \"userName\":\"{{admin-username}}\",\n    \"password\":\"{{admin-password}}\",\n    \"appId\":\"{{application-id}}\",\n    \"clientId\":\"mosip-partner-client\",\n    \"clientSecret\":\"{{mosip-partner-client-secret}}\"\n  }\n}"
						},
						"url": {
							"raw": "{{url}}/v1/authmanager/authenticate/internal/useridPwd",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"authmanager",
								"authenticate",
								"internal",
								"useridPwd"
							]
						}
					},
					"response": []
				},
				{
					"name": "download-ida-root-certificate",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);\r",
									"var data = JSON.stringify(jsonData.response.certificate);\r",
									"console.log(data);\r",
									"pm.environment.set(\"ca-certificate\",data);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "Authorization={{partner-admin-token}}",
									"type": "string"
								},
								{
									"key": "key",
									"value": "Cookie",
									"type": "string"
								},
								{
									"key": "in",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/idauthentication/v1/internal/getCertificate?applicationId={{cert-application-id}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"idauthentication",
								"v1",
								"internal",
								"getCertificate"
							],
							"query": [
								{
									"key": "applicationId",
									"value": "{{cert-application-id}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "download-resident-certificate",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);\r",
									"var data = JSON.stringify(jsonData.response.certificate);\r",
									"console.log(data);\r",
									"pm.environment.set(\"ca-certificate\",data);\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "Authorization={{partner-admin-token}}",
									"type": "string"
								},
								{
									"key": "key",
									"value": "Cookie",
									"type": "string"
								},
								{
									"key": "in",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/v1/keymanager/getCertificate?applicationId={{cert-application-id}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"keymanager",
								"getCertificate"
							],
							"query": [
								{
									"key": "applicationId",
									"value": "{{cert-application-id}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "download-mpartner-default-resident-certificate",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);\r",
									"var data = JSON.stringify(jsonData.response.certificate);\r",
									"console.log(data);\r",
									"pm.environment.set(\"leaf-certificate\",data);\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "Authorization={{partner-admin-token}}",
									"type": "string"
								},
								{
									"key": "key",
									"value": "Cookie",
									"type": "string"
								},
								{
									"key": "in",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/v1/keymanager/getCertificate?applicationId={{cert-application-id}}&referenceId={{cert-reference-id}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"keymanager",
								"getCertificate"
							],
							"query": [
								{
									"key": "applicationId",
									"value": "{{cert-application-id}}"
								},
								{
									"key": "referenceId",
									"value": "{{cert-reference-id}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "download-ida-cred_service-certificate",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);\r",
									"var data = JSON.stringify(jsonData.response.certificate);\r",
									"console.log(data);\r",
									"pm.environment.set(\"leaf-certificate\",data);\r",
									"var jsonData = JSON.parse(responseBody);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "Authorization={{partner-admin-token}}",
									"type": "string"
								},
								{
									"key": "key",
									"value": "Cookie",
									"type": "string"
								},
								{
									"key": "in",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{url}}/idauthentication/v1/internal/getCertificate?applicationId={{cert-application-id}}&referenceId={{cert-reference-id}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"idauthentication",
								"v1",
								"internal",
								"getCertificate"
							],
							"query": [
								{
									"key": "applicationId",
									"value": "{{cert-application-id}}"
								},
								{
									"key": "referenceId",
									"value": "{{cert-reference-id}}"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "cert-upload",
			"item": [
				{
					"name": "upload-ca-certificate",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable('requesttime', (new Date()).toISOString());\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "Authorization={{partner-admin-token}}",
									"type": "string"
								},
								{
									"key": "key",
									"value": "Cookie",
									"type": "string"
								},
								{
									"key": "in",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"id\": \"string\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"certificateData\":{{ca-certificate}},\r\n    \"partnerDomain\": \"{{partner-domain}}\"\r\n  },\r\n  \"requesttime\": \"{{requesttime}}\",\r\n  \"version\": \"string\"\r\n  }\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/partnermanager/partners/certificate/ca/upload",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"partnermanager",
								"partners",
								"certificate",
								"ca",
								"upload"
							]
						},
						"description": "Here It is assumed that the Partner will provide MOSIP with the three certificates, namely ca certificate, intermediate certificate, and partner certificate ."
					},
					"response": []
				},
				{
					"name": "upload-intermediate-ca-certificate",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable('requesttime', (new Date()).toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "Authorization={{partner-admin-token}}",
									"type": "string"
								},
								{
									"key": "key",
									"value": "Cookie",
									"type": "string"
								},
								{
									"key": "in",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"id\": \"string\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"certificateData\":{{intermediate-cert}},\r\n    \"partnerDomain\": \"{{partner-domain}}\"\r\n  },\r\n  \"requesttime\": \"{{requesttime}}\",\r\n  \"version\": \"string\"\r\n  }\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/partnermanager/partners/certificate/ca/upload",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"partnermanager",
								"partners",
								"certificate",
								"ca",
								"upload"
							]
						}
					},
					"response": []
				},
				{
					"name": "upload-leaf-certificate",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable('requesttime', (new Date()).toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "Authorization={{partner-admin-token}}",
									"type": "string"
								},
								{
									"key": "key",
									"value": "Cookie",
									"type": "string"
								},
								{
									"key": "in",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"id\": \"string\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"certificateData\":{{leaf-certificate}},\r\n    \"partnerDomain\": \"{{partner-domain}}\",\r\n    \"partnerId\": \"{{partner-kc-username}}\"\r\n \r\n  },\r\n  \"requesttime\": \"{{requesttime}}\",\r\n  \"version\": \"string\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/partnermanager/partners/certificate/upload",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"partnermanager",
								"partners",
								"certificate",
								"upload"
							]
						},
						"description": "The partner cert will be signed back and shared with the response as well ."
					},
					"response": []
				},
				{
					"name": "upload-signed-leaf-certificate",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"\r",
									"    pm.test(\"Posted Signed certificate\", function () {\r",
									"    var jsonData = pm.response.json();\r",
									"    pm.expect(jsonData.errors).to.eql([]);\r",
									"                     });"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "Authorization={{partner-admin-token}}",
									"type": "string"
								},
								{
									"key": "key",
									"value": "Cookie",
									"type": "string"
								},
								{
									"key": "in",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"id\": \"string\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"applicationId\": \"{{application-id}}\",\r\n    \"certificateData\": {{signed-leaf-certificate}},\r\n    \"referenceId\": \"{{cert-reference-id}}\"\r\n  },\r\n  \"requesttime\": \"2018-12-10T06:12:52.994Z\",\r\n  \"version\": \"string\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/idauthentication/v1/internal/uploadCertificate",
							"host": [
								"{{url}}"
							],
							"path": [
								"idauthentication",
								"v1",
								"internal",
								"uploadCertificate"
							]
						}
					},
					"response": []
				},
				{
					"name": "upload-signed-leaf-certifcate-to-keymanager",
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "Authorization={{partner-admin-token}}",
									"type": "string"
								},
								{
									"key": "key",
									"value": "Cookie",
									"type": "string"
								},
								{
									"key": "in",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"id\": \"string\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"applicationId\": \"{{application-id}}\",\r\n    \"certificateData\":{{signed-leaf-certificate}},\r\n    \"referenceId\": \"{{cert-reference-id}}\"\r\n  },\r\n  \"requesttime\": \"{{requesttime}}\",\r\n  \"version\": \"string\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/keymanager/uploadCertificate",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"keymanager",
								"uploadCertificate"
							]
						}
					},
					"response": []
				},
				{
					"name": "upload-other-domain-certificate-to-keymanager",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"\r",
									"var jsonData = JSON.parse(responseBody);\r",
									"var jsonData = JSON.stringify(jsonData.errors);\r",
									"if (jsonData==\"[]\")\r",
									"{\r",
									"    pm.test(\"uploaded succesfuuly\", function () {\r",
									"    var jsonData = pm.response.json();\r",
									"    pm.expect(jsonData.errors).to.eql([]);\r",
									"});}\r",
									"else\r",
									"{\r",
									"pm.test(\"Certificate already exists in DB\", function () {\r",
									"    pm.expect(pm.response.text()).to.include(\"Certificate already exists,no need to reupload \");\r",
									"});\r",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "apikey",
							"apikey": [
								{
									"key": "value",
									"value": "Authorization={{partner-admin-token}}",
									"type": "string"
								},
								{
									"key": "key",
									"value": "Cookie",
									"type": "string"
								},
								{
									"key": "in",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"id\": \"string\",\r\n  \"version\": \"string\",\r\n  \"requesttime\": \"{{requesttime}}\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"applicationId\": \"{{application-id}}\",\r\n    \"referenceId\": \"{{refrence-id}}\",\r\n    \"certificateData\": {{leaf-certificate}}\r\n  }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/v1/keymanager/uploadOtherDomainCertificate",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"keymanager",
								"uploadOtherDomainCertificate"
							]
						}
					},
					"response": []
				}
			]
		}
	]
}